{"file":"root-component.entry.esm.js","mappings":"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","names":[],"sources":["src/components/root-component/root-component.tsx"],"sourcesContent":["import { Component, Element, h, Listen, State } from '@stencil/core';\n\nconst getMaxVideoMediaDimensions = async (p: { aspectRatio: number; ideal: number }) => {\n  const videoMedia = await navigator.mediaDevices.getUserMedia({\n    audio: false,\n    video: { width: { ideal: p.ideal }, height: { ideal: p.ideal } },\n  });\n\n  const tracks = videoMedia.getVideoTracks();\n  const settings = tracks.find(x => !!x).getSettings();\n\n  const wMax = settings.width;\n  const hMax = settings.height;\n\n  const rtn = (() => {\n    if (wMax / p.aspectRatio <= hMax) return { width: wMax, height: wMax / p.aspectRatio };\n    if (hMax * p.aspectRatio <= wMax) return { width: hMax * p.aspectRatio, height: hMax };\n  })();\n\n  tracks.forEach(track => track.stop());\n  return rtn;\n};\n\nconst getStreamData = (p: { width: number; height: number }): Promise<MediaProvider> => {\n  return new Promise((resolve, reject) => {\n    navigator.mediaDevices\n      .getUserMedia({ video: { width: { ideal: p.width }, height: { ideal: p.height } } })\n      .then(function (initStream) {\n        const stream = initStream as unknown as MediaProvider;\n        resolve(stream);\n      })\n      .catch(function (error) {\n        window.alert('Error accessing webcam:');\n        console.error('Error accessing webcam:', error);\n        reject();\n      });\n  });\n};\n\ntype TScreenStatus =\n  | 'init_screen'\n  | 'edit_settings_screen'\n  | 'start_guestbook_screen'\n  | 'capture_countdown_screen'\n  | 'print_photo_success_screen'\n  | 'print_photo_fail_screen'\n  | 'control_panel_screen';\ndeclare global {\n  interface Window {\n    streamData: MediaProvider | undefined;\n  }\n}\n\n@Component({\n  tag: 'root-component',\n  shadow: true,\n})\nexport class RootComponent {\n  @State() screenStatus: TScreenStatus = 'init_screen';\n  @State() streamDims: { width: number; height: number } | undefined = undefined;\n  @State() streamDataIsReady: boolean = false;\n  @State() sendPhotoErrorName: string | undefined = undefined;\n\n  @Listen('clickInitScreenEditSettingsButton')\n  clickSettingsButtonHandler() {\n    this.screenStatus = 'edit_settings_screen';\n  }\n  @Listen('goToStartGuestbookScreen')\n  goToStartGuestbookScreen() {\n    this.screenStatus = 'start_guestbook_screen';\n  }\n  @Listen('goToPrintPhotoSuccessScreen')\n  goToPrintPhotoSuccessScreen() {\n    this.screenStatus = 'print_photo_success_screen';\n  }\n  @Listen('goToPrintPhotoFailScreen')\n  goToPrintPhotoFailScreen(e: CustomEvent<string>) {\n    this.sendPhotoErrorName = e.detail;\n    this.screenStatus = 'print_photo_fail_screen';\n  }\n  @Listen('goToControlPanelScreen')\n  goToControlPanelScreen() {\n    this.screenStatus = 'control_panel_screen';\n  }\n\n  @Listen('startCaptureCountdown')\n  startCaptureCountdown() {\n    this.screenStatus = 'capture_countdown_screen';\n  }\n\n  @Element() el: HTMLElement;\n\n  constructor() {\n    (async () => {\n      this.streamDims = await getMaxVideoMediaDimensions({ ideal: 1080, aspectRatio: 6 / 4 });\n\n      window.streamData = await getStreamData(this.streamDims);\n      this.streamDataIsReady = true;\n    })();\n  }\n\n  render() {\n    return (\n      <div>\n        {/* this.screenStatus: {this.screenStatus} */}\n        {this.screenStatus === 'init_screen' && <init-screen />}\n        {this.screenStatus === 'edit_settings_screen' && <edit-settings-screen />}\n        {this.screenStatus === 'control_panel_screen' && <control-panel-screen />}\n        {this.screenStatus === 'start_guestbook_screen' && !this.streamDataIsReady && <loading-guestbook-screen />}\n        {this.screenStatus === 'start_guestbook_screen' && this.streamDataIsReady && <start-guestbook-screen width={this.streamDims?.width} height={this.streamDims?.height} />}\n        {this.screenStatus === 'capture_countdown_screen' && <capture-countdown-screen width={this.streamDims?.width} height={this.streamDims?.height} />}\n        {this.screenStatus === 'print_photo_success_screen' && <print-photo-success-screen />}\n        {this.screenStatus === 'print_photo_fail_screen' && <print-photo-fail-screen error={this.sendPhotoErrorName} />}\n      </div>\n    );\n  }\n}\n"],"version":3}